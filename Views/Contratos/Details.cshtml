@model Inmobiliaria_Zarate_DoNet.Models.Contrato
@using Inmobiliaria_Zarate_DoNet.Utils
@{
    ViewData["Title"] = "Detalle de contrato";
    var rol = Context.Session.GetString(SessionKeys.UserRol);
    var creadoPorNombre = ViewBag.CreadoPorNombre as string;
    var terminadoPorNombre = ViewBag.TerminadoPorNombre as string;
}

<h2>@ViewData["Title"]</h2>

<dl class="row">
    <dt class="col-sm-3">Inmueble</dt>
    <dd class="col-sm-9">@Model.InmuebleDireccion (@Model.InmuebleId)</dd>

    <dt class="col-sm-3">Inquilino</dt>
    <dd class="col-sm-9">@Model.InquilinoNombre (@Model.InquilinoId)</dd>

    <dt class="col-sm-3">Inicio</dt>
    <dd class="col-sm-9">@Model.FechaInicio.ToString("yyyy-MM-dd")</dd>

    <dt class="col-sm-3">Fin original</dt>
    <dd class="col-sm-9">@Model.FechaFinOriginal.ToString("yyyy-MM-dd")</dd>

    <dt class="col-sm-3">Fecha fin efectiva</dt>
    <dd class="col-sm-9">@((Model.FechaFinAnticipada.HasValue) ? Model.FechaFinAnticipada.Value.ToString("yyyy-MM-dd") :
                "-")</dd>

    <dt class="col-sm-3">Monto mensual</dt>
    <dd class="col-sm-9">@Model.MontoMensual.ToString("C")</dd>

    <dt class="col-sm-3">Estado</dt>
    <dd class="col-sm-9">@Model.Estado</dd>
</dl>

@if (rol == "ADMIN")
{
    <hr />
    <h4>Auditor√≠a</h4>
    <dl class="row">
        <dt class="col-sm-3">Creado por</dt>
        <dd class="col-sm-9">
            @((!string.IsNullOrWhiteSpace(creadoPorNombre) ? creadoPorNombre : "(sin datos)")) (@Model.CreadoPor)
        </dd>

        <dt class="col-sm-3">Creado en</dt>
        <dd class="col-sm-9">@Model.CreadoEn.ToString("yyyy-MM-dd HH:mm")</dd>

        @if (Model.TerminadoPor.HasValue)
        {
            <dt class="col-sm-3">Terminado por</dt>
            <dd class="col-sm-9">
                @((!string.IsNullOrWhiteSpace(terminadoPorNombre) ? terminadoPorNombre : "(sin datos)")) (@Model.TerminadoPor)
            </dd>
        }
    </dl>
}

<p class="mt-3">
    <a asp-controller="Pagos" asp-action="PorContrato" asp-route-contratoId="@Model.Id" class="btn btn-outline-primary">
        Ver / cargar pagos
    </a>
    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary">Editar</a>
    @if (rol == "ADMIN")
    {
        <a asp-action="Terminar" asp-route-id="@Model.Id" class="btn btn-warning">Terminar</a>
        <a asp-action="Delete" asp-route-id="@Model.Id" class="btn btn-danger">Eliminar</a>
    }
    <a asp-action="Index" class="btn btn-secondary">Volver</a>
</p>